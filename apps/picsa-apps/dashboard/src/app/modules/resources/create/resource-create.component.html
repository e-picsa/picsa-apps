<div class="page-content">
  <h2>New Resource</h2>

  <div style="margin-bottom: 1rem">
    <label style="display: block; margin-bottom: 8px">Resource Type</label>
    <mat-radio-group [(ngModel)]="resourceType">
      <mat-radio-button value="file">File</mat-radio-button>
      <mat-radio-button value="link">Link</mat-radio-button>
    </mat-radio-group>
  </div>

  @if (resourceType==='file') {
  <form [formGroup]="fileForm">
    <label style="display: block; margin-bottom: 8px">Resource File</label>
    <picsa-supabase-upload
      [disabled]="uploadedFile ? true : false"
      [fileDropHeight]="128"
      style="width: 300px"
      [autoUpload]="true"
      storageBucketName="resources"
      (uploadComplete)="handleUploadComplete($event)"
    ></picsa-supabase-upload>
    @if(uploadedFile){

    <a [href]="uploadedFile.publicUrl" target="_blank" rel="noopener" style="margin-top: 1rem">
      <mat-chip class="file-chip">
        <div style="display: flex; align-items: center; gap: 4px; padding: 4px 0">
          <span>{{ uploadedFile.name }}</span>
          <mat-icon>open_in_new</mat-icon>
        </div>
      </mat-chip>
    </a>

    }
  </form>

  } @if (resourceType==='link') {
  <form [formGroup]="linkForm">
    <mat-form-field>
      <mat-label>URL</mat-label>
      <input matInput type="text" formControlName="url" placeholder="https://..." />
    </mat-form-field>
    @if (linkForm.controls.url.errors) {
    <mat-error>Please enter a valid url</mat-error>
    }
  </form>
  }
</div>
